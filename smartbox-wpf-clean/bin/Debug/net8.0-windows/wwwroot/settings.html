<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartBox Settings</title>
    <link rel="stylesheet" href="settings.css">
    <link rel="stylesheet" href="keyboard.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/segoe-fluent-icons/font/SegoeFluentIcons.css">
</head>
<body>
    <div class="settings-container">
        <!-- Header -->
        <header class="settings-header">
            <button class="back-button" id="backButton">
                <i class="ms-Icon ms-Icon--ChevronLeft"></i>
                <span>Back</span>
            </button>
            <h1>Settings</h1>
            <div class="header-actions">
                <button class="save-button" id="saveButton" data-action="savesettings" data-collect-form="settingsForm">
                    <i class="ms-Icon ms-Icon--Save"></i>
                    <span>Save</span>
                </button>
            </div>
        </header>

        <!-- Settings Content -->
        <div class="settings-content">
            <nav class="settings-nav">
                <button class="nav-item active" data-section="storage">
                    <i class="ms-Icon ms-Icon--FabricFolder"></i>
                    <span>Storage</span>
                </button>
                <button class="nav-item" data-section="pacs">
                    <i class="ms-Icon ms-Icon--ServerEnviroment"></i>
                    <span>PACS</span>
                </button>
                <button class="nav-item" data-section="mwl">
                    <i class="ms-Icon ms-Icon--TaskList"></i>
                    <span>Worklist</span>
                </button>
                <button class="nav-item" data-section="video">
                    <i class="ms-Icon ms-Icon--Video"></i>
                    <span>Video</span>
                </button>
                <button class="nav-item" data-section="application">
                    <i class="ms-Icon ms-Icon--Settings"></i>
                    <span>Application</span>
                </button>
            </nav>

            <main class="settings-main">
                <form id="settingsForm">
                <!-- Storage Section -->
                <section id="storage-section" class="settings-section active">
                    <h2>Storage Settings</h2>
                    
                    <div class="setting-group">
                        <label for="storage-photos-path">Photos Directory</label>
                        <div class="input-with-button">
                            <input type="text" id="storage-photos-path" class="use-keyboard" value="./Data/Photos">
                            <button type="button" class="browse-button" data-action="browsefolder" data-for="storage-photos-path">
                                <i class="ms-Icon ms-Icon--FolderOpen"></i>
                            </button>
                        </div>
                        <p class="help-text">Directory where captured photos will be saved</p>
                    </div>

                    <div class="setting-group">
                        <label for="storage-videos-path">Videos Directory</label>
                        <div class="input-with-button">
                            <input type="text" id="storage-videos-path" class="use-keyboard" value="./Data/Videos">
                            <button type="button" class="browse-button" data-action="browsefolder" data-for="storage-videos-path">
                                <i class="ms-Icon ms-Icon--FolderOpen"></i>
                            </button>
                        </div>
                        <p class="help-text">Directory where recorded videos will be saved</p>
                    </div>

                    <div class="setting-group">
                        <label for="storage-dicom-path">DICOM Directory</label>
                        <div class="input-with-button">
                            <input type="text" id="storage-dicom-path" class="use-keyboard" value="./Data/DICOM">
                            <button type="button" class="browse-button" data-action="browsefolder" data-for="storage-dicom-path">
                                <i class="ms-Icon ms-Icon--FolderOpen"></i>
                            </button>
                        </div>
                        <p class="help-text">Directory for DICOM file storage and export queue</p>
                    </div>

                    <div class="setting-group">
                        <label for="storage-temp-path">Temporary Directory</label>
                        <div class="input-with-button">
                            <input type="text" id="storage-temp-path" class="use-keyboard" value="./Data/Temp">
                            <button type="button" class="browse-button" data-action="browsefolder" data-for="storage-temp-path">
                                <i class="ms-Icon ms-Icon--FolderOpen"></i>
                            </button>
                        </div>
                        <p class="help-text">Directory for temporary files during processing</p>
                    </div>

                    <div class="setting-group">
                        <label for="storage-queue-path">Queue Directory</label>
                        <div class="input-with-button">
                            <input type="text" id="storage-queue-path" class="use-keyboard" value="./Data/Queue">
                            <button type="button" class="browse-button" data-action="browsefolder" data-for="storage-queue-path">
                                <i class="ms-Icon ms-Icon--FolderOpen"></i>
                            </button>
                        </div>
                        <p class="help-text">Directory for PACS upload queue</p>
                    </div>

                    <div class="setting-group">
                        <label for="storage-max-storage-days">Max Storage Days</label>
                        <input type="number" id="storage-max-storage-days" class="use-keyboard numeric-input" value="30" min="1" max="365">
                        <p class="help-text">Maximum days to keep files before auto-cleanup (1-365)</p>
                    </div>

                    <div class="setting-group">
                        <label for="storage-enable-auto-cleanup">Enable Auto-Cleanup</label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="storage-enable-auto-cleanup">
                            <span class="toggle-slider"></span>
                        </label>
                        <p class="help-text">Automatically delete old files after max storage days</p>
                    </div>
                </section>

                <!-- PACS Section -->
                <section id="pacs-section" class="settings-section">
                    <h2>PACS Configuration</h2>
                    
                    <div class="setting-group">
                        <label for="pacs-enabled">Enable PACS</label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="pacs-enabled">
                            <span class="toggle-slider"></span>
                        </label>
                        <p class="help-text">Enable DICOM image export to PACS server</p>
                    </div>
                    
                    <div class="setting-group">
                        <label for="pacs-server-host">Server IP Address</label>
                        <input type="text" id="pacs-server-host" class="use-keyboard" value="192.168.1.100">
                        <p class="help-text">IP address or hostname of the PACS server</p>
                    </div>

                    <div class="setting-group">
                        <label for="pacs-server-port">Server Port</label>
                        <input type="number" id="pacs-server-port" class="use-keyboard numeric-input" value="104" min="1" max="65535">
                        <p class="help-text">DICOM port (usually 104 or 11112)</p>
                    </div>

                    <div class="setting-group">
                        <label for="pacs-called-ae-title">Server AE Title</label>
                        <input type="text" id="pacs-called-ae-title" class="use-keyboard" value="PACS_SERVER">
                        <p class="help-text">Application Entity title of the PACS server</p>
                    </div>

                    <div class="setting-group">
                        <label for="pacs-calling-ae-title">Local AE Title</label>
                        <input type="text" id="pacs-calling-ae-title" class="use-keyboard" value="SMARTBOX">
                        <p class="help-text">This device's Application Entity title</p>
                    </div>

                    <div class="setting-group">
                        <label for="pacs-timeout">Timeout (seconds)</label>
                        <input type="number" id="pacs-timeout" class="use-keyboard numeric-input" value="30" min="5" max="300">
                        <p class="help-text">Connection timeout in seconds (5-300)</p>
                    </div>

                    <div class="setting-group">
                        <label for="pacs-max-retries">Max Retries</label>
                        <input type="number" id="pacs-max-retries" class="use-keyboard numeric-input" value="3" min="0" max="10">
                        <p class="help-text">Maximum retry attempts for failed uploads (0-10)</p>
                    </div>

                    <div class="setting-group">
                        <label for="pacs-retry-delay">Retry Delay (seconds)</label>
                        <input type="number" id="pacs-retry-delay" class="use-keyboard numeric-input" value="5" min="1" max="60">
                        <p class="help-text">Delay between retry attempts (1-60 seconds)</p>
                    </div>

                    <div class="setting-group">
                        <button type="button" class="test-button" id="test-pacs" data-action="testpacsconnection">
                            <i class="ms-Icon ms-Icon--TestBeaker"></i>
                            <span>Test Connection</span>
                        </button>
                    </div>
                </section>

                <!-- MWL Section -->
                <section id="mwl-section" class="settings-section">
                    <h2>Modality Worklist (MWL)</h2>
                    
                    <div class="setting-group">
                        <label for="mwlsettings-enable-worklist">Enable Worklist</label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="mwlsettings-enable-worklist">
                            <span class="toggle-slider"></span>
                        </label>
                        <p class="help-text">Enable DICOM Modality Worklist query for patient data</p>
                    </div>

                    <div class="setting-group">
                        <label for="mwlsettings-mwl-server-host">MWL Server IP Address</label>
                        <input type="text" id="mwlsettings-mwl-server-host" class="use-keyboard" value="192.168.1.100">
                        <p class="help-text">IP address of the Worklist server (often same as PACS)</p>
                    </div>

                    <div class="setting-group">
                        <label for="mwlsettings-mwl-server-port">MWL Server Port</label>
                        <input type="number" id="mwlsettings-mwl-server-port" class="use-keyboard numeric-input" value="105" min="1" max="65535">
                        <p class="help-text">DICOM port for worklist queries (usually 104 or 11112)</p>
                    </div>

                    <div class="setting-group">
                        <label for="mwlsettings-mwl-server-aet">MWL Server AE Title</label>
                        <input type="text" id="mwlsettings-mwl-server-aet" class="use-keyboard" value="MWL_SERVER">
                        <p class="help-text">Application Entity title of the Worklist server</p>
                    </div>

                    <div class="setting-group">
                        <label for="mwlsettings-cache-expiry-hours">Cache Duration (Hours)</label>
                        <input type="number" id="mwlsettings-cache-expiry-hours" class="use-keyboard numeric-input" value="24" min="1" max="168">
                        <p class="help-text">How long to keep worklist entries in offline cache (1-168 hours)</p>
                    </div>

                    <div class="setting-group">
                        <label for="mwlsettings-auto-refresh-seconds">Auto-Refresh Interval (seconds)</label>
                        <input type="number" id="mwlsettings-auto-refresh-seconds" class="use-keyboard numeric-input" value="300" min="60" max="3600">
                        <p class="help-text">How often to refresh worklist automatically (60-3600 seconds)</p>
                    </div>

                    <div class="setting-group">
                        <label for="mwlsettings-show-emergency-first">Show Emergency First</label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="mwlsettings-show-emergency-first" checked>
                            <span class="toggle-slider"></span>
                        </label>
                        <p class="help-text">Display emergency patients at the top of the worklist</p>
                    </div>

                    <div class="setting-group">
                        <button type="button" class="test-button" id="test-mwl" data-action="testmwlconnection">
                            <i class="ms-Icon ms-Icon--TestBeaker"></i>
                            <span>Test MWL Connection</span>
                        </button>
                    </div>
                </section>

                <!-- Video Section -->
                <section id="video-section" class="settings-section">
                    <h2>Video Settings</h2>
                    
                    <div class="setting-group">
                        <label for="video-default-resolution">Default Resolution</label>
                        <select id="video-default-resolution">
                            <option value="1920x1080">1920x1080 (Full HD)</option>
                            <option value="1280x720" selected>1280x720 (HD)</option>
                            <option value="640x480">640x480 (VGA)</option>
                        </select>
                        <p class="help-text">Default video capture resolution</p>
                    </div>

                    <div class="setting-group">
                        <label for="video-default-frame-rate">Default Frame Rate</label>
                        <input type="number" id="video-default-frame-rate" class="use-keyboard numeric-input" value="30" min="15" max="60">
                        <p class="help-text">Default frames per second (15-60)</p>
                    </div>

                    <div class="setting-group">
                        <label for="video-default-quality">Default Quality (%)</label>
                        <input type="number" id="video-default-quality" class="use-keyboard numeric-input" value="85" min="50" max="100">
                        <p class="help-text">JPEG compression quality for photos (50-100)</p>
                    </div>

                    <div class="setting-group">
                        <label for="video-enable-hardware-acceleration">Hardware Acceleration</label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="video-enable-hardware-acceleration" checked>
                            <span class="toggle-slider"></span>
                        </label>
                        <p class="help-text">Use GPU for video encoding when available</p>
                    </div>

                    <div class="setting-group">
                        <label for="video-preferred-camera">Preferred Camera</label>
                        <input type="text" id="video-preferred-camera" class="use-keyboard" placeholder="Auto-detect">
                        <p class="help-text">Camera device name or leave empty for auto-detection</p>
                    </div>
                </section>

                <!-- Application Section -->
                <section id="application-section" class="settings-section">
                    <h2>Application Settings</h2>
                    
                    <div class="setting-group">
                        <label for="application-auto-start-capture">Auto-Start Capture</label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="application-auto-start-capture" checked>
                            <span class="toggle-slider"></span>
                        </label>
                        <p class="help-text">Automatically initialize webcam on startup</p>
                    </div>

                    <div class="setting-group">
                        <label for="application-language">Language</label>
                        <select id="application-language">
                            <option value="de-DE">Deutsch</option>
                            <option value="en-US">English</option>
                        </select>
                        <p class="help-text">User interface language</p>
                    </div>

                    <div class="setting-group">
                        <label for="application-theme">Theme</label>
                        <select id="application-theme">
                            <option value="Light">Light</option>
                            <option value="Dark">Dark</option>
                        </select>
                        <p class="help-text">Application color theme</p>
                    </div>

                    <div class="setting-group">
                        <label for="application-enable-touch-keyboard">Touch Keyboard</label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="application-enable-touch-keyboard" checked>
                            <span class="toggle-slider"></span>
                        </label>
                        <p class="help-text">Enable on-screen touch keyboard</p>
                    </div>

                    <div class="setting-group">
                        <label for="application-enable-debug-mode">Debug Mode</label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="application-enable-debug-mode">
                            <span class="toggle-slider"></span>
                        </label>
                        <p class="help-text">Show debug information and logs</p>
                    </div>

                    <div class="setting-group">
                        <label for="application-web-server-port">Web Server Port</label>
                        <input type="number" id="application-web-server-port" class="use-keyboard numeric-input" value="5112" min="1024" max="65535">
                        <p class="help-text">Local web server port (1024-65535)</p>
                    </div>

                    <div class="setting-group">
                        <label for="application-enable-remote-access">Remote Access</label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="application-enable-remote-access">
                            <span class="toggle-slider"></span>
                        </label>
                        <p class="help-text">Allow remote configuration access</p>
                    </div>

                    <div class="setting-group">
                        <label for="application-hide-exit-button">Hide Exit Button</label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="application-hide-exit-button">
                            <span class="toggle-slider"></span>
                        </label>
                        <p class="help-text">Hide the application exit button (kiosk mode)</p>
                    </div>

                    <div class="setting-group">
                        <label for="application-enable-emergency-templates">Emergency Templates</label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="application-enable-emergency-templates" checked>
                            <span class="toggle-slider"></span>
                        </label>
                        <p class="help-text">Enable quick emergency patient templates (Male/Female/Child)</p>
                    </div>
                </section>
                </form>
            </main>
        </div>
    </div>

    <script src="js/actions.js"></script>
    <script src="js/settings-handler.js"></script>
    <script src="settings.js"></script>
    <script src="keyboard.js"></script>
</body>
</html>